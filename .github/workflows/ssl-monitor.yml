name: SSL Automation CI/CD Workflow

on:
  push:
    branches: [ main ]

jobs:
  ssl-check:
    runs-on: windows-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Install OpenSSL
        run: choco install openssl.light -y

      - name: Run SSL Test with Expiry & Auto-Renew
        shell: cmd
        run: |
          echo ========================================
          echo üîê Starting SSL Automation Pipeline
          echo ========================================
          mkdir ssl-test
          cd ssl-test
          echo ‚úÖ Generating an expired certificate (-days 0)...
          openssl req -x509 -nodes -days 0 -newkey rsa:2048 -keyout demo.key -out demo.crt -subj "/CN=localhost"
          echo ‚úÖ Expired certificate created.
          openssl x509 -in demo.crt -enddate -noout
          echo ‚ö†Ô∏è ALERT: Certificate expired! Auto-renewal triggered...
          openssl req -x509 -nodes -days 5 -newkey rsa:2048 -keyout demo.key -out demo.crt -subj "/CN=localhost"
          echo ‚úÖ New certificate generated successfully (after auto-renewal).
          echo ========================================
          echo ‚úÖ SSL Auto-Renewal Workflow Completed
